<!DOCTYPE html>
<html lang="en">

<head>
  <title>MyBlog - Home</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/style.css" rel="stylesheet">
  <style>
    .category-badge {
      display: inline-block;
      margin-top: 5px;
      margin-bottom: 5px;
      padding: 2px 8px;
      background-color: #6c757d;
      color: white;
      border-radius: 4px;
      font-size: 0.85rem;
    }

    .trending-title {
      margin-top: 40px;
      margin-bottom: 20px;
      text-align: center;
    }

    .trending-card img {
      height: 180px;
      object-fit: cover;
    }

    .card-body {
      display: flex;
      flex-direction: column;
    }

    .card-footer a {
      text-decoration: none;
    }
  </style>
</head>

<body>
  <%- include("partials/navbar") %>

  <!-- Hero Section -->
  <header class="bg-primary text-light text-center py-5">
    <div class="container">
      <h1 class="display-4 fw-bold">Welcome to MyBlog</h1>
      <p class="lead">Share your thoughts, ideas, and stories with the world</p>
      <% if (!user) { %>
        <a href="/register" class="btn btn-light btn-lg me-2">Get Started</a>
        <a href="/login" class="btn btn-outline-light btn-lg">Login</a>
      <% } else { %>
        <a href="/blogs" class="btn btn-light btn-lg me-2">Explore Blogs</a>
        <a href="/user/profile" class="btn btn-outline-light btn-lg">My Profile</a>
      <% } %>
    </div>
  </header>

  <!-- Trending Blogs -->
  <% if (trendingBlogs && trendingBlogs.length > 0) { %>
    <div class="container my-5">
      <h3 class="trending-title">üî• Trending Blogs</h3>
      <div class="row">
        <% trendingBlogs.forEach(blog => { %>
          <div class="col-md-4 mb-4">
            <div class="card shadow-sm trending-card h-100">
              <% if (blog.thumbnail) { %>
                <img src="/images/uploads/<%= blog.thumbnail %>" class="card-img-top">
              <% } %>
              <div class="card-body">
                <h5 class="card-title">
                  <a href="/blogs/<%= blog._id %>" class="text-decoration-none"><%= blog.title %></a>
                </h5>
                <p class="card-text text-muted">
                  By <%= blog.user.name %> | <%= new Date(blog.createdAt).toDateString() %>
                </p>
                <p class="card-text">
                  ‚ù§Ô∏è <%= blog.likes.length %> | üí¨ <%= blog.comments.length %>
                </p>
                <% if (blog.category) { %>
                  <span class="category-badge"><%= blog.category %></span>
                <% } %>
              </div>
              <div class="card-footer small text-muted">
                By <a href="/blogs/profile/<%= blog.user.id %>"><%= blog.user.name %></a> |
                <%= blog.createdAt.toDateString() %>
              </div>
            </div>
          </div>
        <% }) %>
      </div>
    </div>
  <% } %>

  <!-- Latest Blogs -->
  <main class="container my-5">
    <h2 class="text-center mb-4">üìö Latest Blogs</h2>
    <div class="row">
      <% if (posts && posts.length > 0) { %>
        <% posts.forEach(post => { %>
          <div class="col-md-4 mb-4">
            <div class="card shadow-sm h-100">
              <img src="/images/uploads/<%= post.thumbnail || 'default.webp' %>" class="card-img-top"
                style="height:180px; object-fit:cover;">
              <div class="card-body d-flex flex-column">
                <h5 class="card-title"><%= post.title %></h5>
                <% if (post.category) { %>
                  <a href="/blogs/category/<%= post.category %>" class="category-badge"><%= post.category %></a>
                <% } %>
                <p class="card-text text-muted mt-2"><%= post.content.substring(0, 100) %>...</p>
                <a href="/blogs/<%= post._id %>" class="btn btn-outline-primary mt-auto">Read More</a>
              </div>
              <div class="card-footer small text-muted">
                By <a href="/blogs/profile/<%= post.user.id %>"><%= post.user.name %></a> |
                <%= post.createdAt.toDateString() %>
              </div>
            </div>
          </div>
        <% }) %>
      <% } else { %>
        <p class="text-center text-muted">No blogs yet. Be the first to <a href="/blogs/create">create one</a>!</p>
      <% } %>
    </div>
    <div class="text-center mt-4">
      <a href="/blogs" class="btn btn-lg btn-secondary">View All Blogs</a>
    </div>
  </main>

  <%- include("partials/footer") %>
</body>

</html>
