<!DOCTYPE html>
<html lang="en">

<head>
    <title>
        <%= user.name %> - Public Profile
    </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <%- include("partials/navbar") %>

        <div class="container mt-5">
            <div class="card shadow-sm mb-5 p-4 text-center">
                <img src="<%= user.profilepic ? '/images/uploads/' + user.profilepic : '/images/default-profile.png' %>"
                    alt="Profile Picture" class="profile-pic mb-3 rounded-circle"
                    style="width:120px;height:120px;object-fit:cover;">
                <h3>
                    <%= user.name %>
                </h3>
                <p>
                    <%= user.bio || "No bio available." %>
                </p>
            </div>

            <h4 class="mb-3">
                <%= user.name %>'s Blogs (<%= user.posts.length %>)
            </h4>
            <div class="row mb-4">
                <div class="col-md-4">
                    <div class="card text-center p-3">
                        <h5>Total Blogs</h5>
                        <h3>
                            <%= totalBlogs %>
                        </h3>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card text-center p-3">
                        <h5>Total Likes</h5>
                        <h3>
                            <%= totalLikes %>
                        </h3>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card text-center p-3">
                        <h5>Most Popular Blog</h5>
                        <% if (mostPopularBlog) { %>
                            <a href="/blogs/<%= mostPopularBlog._id %>">
                                <%= mostPopularBlog.title %>
                            </a>
                            <p>
                                <%= mostPopularBlog.likes.length %> ❤️
                            </p>
                            <% } else { %>
                                <p>None</p>
                                <% } %>
                    </div>
                </div>
            </div>

            <% if (user.posts.length> 0) { %>
                <div class="row">
                    <% user.posts.forEach(post=> { %>
                        <div class="col-md-6 mb-4">
                            <div class="card h-100">
                                <% if (post.thumbnail) { %>
                                    <img src="/images/uploads/<%= post.thumbnail %>" class="card-img-top"
                                        style="height:180px;object-fit:cover;">
                                    <% } %>
                                        <div class="card-body">
                                            <h5 class="card-title"><a href="/blogs/<%= post._id %>">
                                                    <%= post.title %>
                                                </a></h5>
                                            <% if (post.category) { %>
                                                <p><small class="text-muted">Category: <a
                                                            href="/blogs/category/<%= post.category %>">
                                                            <%= post.category %>
                                                        </a></small></p>
                                                <% } %>
                                                    <% if (post.tags && post.tags.length> 0) { %>
                                                        <p>
                                                            <% post.tags.forEach(tag=> { %>
                                                                <a href="/blogs/tag/<%= tag %>"
                                                                    class="badge bg-secondary text-decoration-none">
                                                                    <%= tag %>
                                                                </a>
                                                                <% }) %>
                                                        </p>
                                                        <% } %>
                                        </div>
                            </div>
                        </div>
                        <% }) %>
                </div>
                <% } else { %>
                    <p class="text-muted">No blogs yet.</p>
                    <% } %>
        </div>
</body>

</html>